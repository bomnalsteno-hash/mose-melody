# Morse Melody 웹앱 — 모바일/작은 창에서 잘리는 문제 정리

> **이 문서의 목적:** 모바일이나 브라우저 창 크기가 작을 때 화면이 잘리는 문제를 해결하기 위해, 현재 상황을 정리한 뒤 제미나이(Gemini) 등과 해결책을 논의하기 위함입니다.  
> **핵심: 지금의 문제는 “모바일 또는 창 크기가 작을 때 레이아웃이 잘리는 것”을 해결하는 것입니다.**

---

## 1. 지금 겪고 있는 문제 (핵심)

- **모바일**에서 접속하거나, **데스크톱에서 브라우저 창을 줄였을 때** 화면이 잘립니다.
- 구체적으로:
  - **비주얼라이저 영역**이 잘려서, **모스 코드 타임라인**이나 **재생 중인 문자(예: ‘H’)** 가 잘리거나 가려짐.
  - **하단 입력창·설정(테마 모드, 퀵 프리셋, Generate Music 버튼 등)** 이 화면 밖으로 나가서 잘리거나, 스크롤이 의도대로 동작하지 않음.
- 사용자 요구사항:
  - **비주얼라이저**는 창이 줄어들어도 **모스 코드·문자 영역이 잘리지 않을 만큼** 크기를 유지해야 함.
  - **모스 코드와 문자**는 비주얼라이저 **정중앙**에 보여야 함.
  - **입력창·설정 패널**은 창이 작을 때 **스크롤**해서 모두 볼 수 있어야 함.

---

## 2. 원하는 동작 (목표)

- **뷰포트가 좁을 때(모바일 또는 창 축소):**
  1. **비주얼라이저**  
     - 높이가 고정되거나 최소 높이가 보장되어, **모스 코드 타임라인 + 현재 재생 문자**가 **잘리지 않고** 보임.  
     - 모스 코드·문자는 **비주얼라이저의 가운데**에 표시.
  2. **헤더**  
     - 상단에 고정되어 항상 보임.
  3. **입력창·설정·버튼**  
     - 비주얼라이저 아래 한 블록으로 배치되고, **그 블록만 스크롤**되며 모든 컨트롤에 접근 가능.

- **뷰포트가 넓을 때(데스크톱, 1024px 이상):**  
  - 기존처럼 풀스크린 비주얼라이저 + 하단 오버레이 패널 유지해도 됨.

---

## 3. 현재 구조 요약

- **스택:** Vite + React + TypeScript, Tailwind CSS.
- **레이아웃:**
  - **좁은 뷰포트 (`lg` 미만, 1024px 미만):**
    - `h-screen overflow-hidden` 인 flex 컨테이너.
    - **헤더** → **비주얼라이저 컨테이너(고정 높이 320px, min-h 240px)** → **main(입력/설정, flex-1 min-h-0 overflow-y-auto)**.
  - **넓은 뷰포트 (1024px 이상):**  
    - 풀스크린 비주얼라이저 + 하단 고정 오버레이 패널.

- **비주얼라이저 (`Visualizer.tsx`):**
  - Canvas로 배경·별·모스 타임라인·재생 중 문자·플레이헤드·파티클 등을 그림.
  - 캔버스 크기는 부모 컨테이너 `getBoundingClientRect()` 기준으로 설정.
  - 문자는 `centerY = height/2`, 타임라인은 `trackY = centerY + 60` 등으로 중앙 근처에 배치.

---

## 4. 이미 시도한 것들

- **브레이크포인트:** `md`(768px) → `lg`(1024px)로 올려, 창을 줄이면 “스택형” 레이아웃이 나오도록 함.
- **비주얼라이저:**  
  - 고정 높이 320px, `min-h-[240px]` 적용.  
  - 문자/타임라인을 `height/2` 기준으로 중앙 배치.
- **하단 패널:**  
  - `flex-1 min-h-0 overflow-y-auto` 로 남은 높이만 쓰고 스크롤되도록 함.
- 그럼에도 **모바일이나 창을 줄였을 때** 여전히:
  - 비주얼라이저가 잘리거나,
  - 모스 코드·문자가 중앙이 아니라 약간 아래/위에 보이거나,
  - 하단 입력·설정이 잘리거나 스크롤이 기대대로 되지 않는 문제가 남아 있음.

---

## 5. 해결하고 싶은 것 (제미나이에게 요청할 포인트)

- **“모바일이나 창 크기가 작을 때 잘리는 문제”** 를 해결할 수 있는 **구체적인 레이아웃/구현 방법**을 제안해 주었으면 합니다.
- 특히:
  1. **비주얼라이저**  
     - 창이 작아져도 **모스 코드·문자 영역이 잘리지 않게** 하면서,  
     - 해당 영역을 **항상 비주얼라이저의 정중앙**에 두는 방법 (CSS/픽셀/비율 등).
  2. **입력·설정 패널**  
     - 작은 뷰포트에서 **반드시 스크롤**되게 하고,  
     - 헤더·비주얼라이저와 겹치거나 잘리지 않게 하는 **flex/overflow/height 계산** 방법.
  3. **선택지**  
     - `100dvh` / `100svh` 사용,  
     - 비주얼라이저 높이를 `min(320px, 50dvh)` 같은 식으로 두는 것,  
     - 또는 아예 레이아웃 구조를 바꾸는 것 등 **추천할 수 있는 패턴**이 있다면 알려 주었으면 합니다.

---

## 6. 관련 파일

| 파일 | 역할 |
|------|------|
| `App.tsx` | 메인 레이아웃, 모바일/데스크톱 분기, 헤더·비주얼라이저·입력/설정 영역 배치 |
| `components/Visualizer.tsx` | Canvas 비주얼라이저, 모스 타임라인·문자·플레이헤드 그리기 |
| Tailwind | 반응형 클래스 (`lg:hidden`, `hidden lg:block`, `flex-1`, `min-h-0`, `overflow-y-auto` 등) |

---

**요약:**  
지금의 문제는 **모바일이나 창 크기가 작을 때 화면이 잘리는 것**입니다. 비주얼라이저는 모스 코드·문자가 잘리지 않고 정중앙에 보이게 하고, 입력·설정은 스크롤로 모두 볼 수 있게 하는 **해결책**을 찾고 있습니다.
